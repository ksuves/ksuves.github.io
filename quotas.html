<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Quotas ‚Äî –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–∏—Å–∫–æ–≤–æ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞</title>
<style>
  body {
    font-family: "Segoe UI", Roboto, sans-serif;
    line-height: 1.6;
    background-color: #fdfdfd;
    color: #222;
    margin: 0;
    padding: 2em;
    max-width: 900px;
    margin-left: auto;
    margin-right: auto;
  }
  h1, h2, h3 {
    color: #333;
  }
  ol {
    padding-left: 1.5em;
  }
  pre {
    background: #f4f4f4;
    border: 1px solid #ddd;
    border-radius: 8px;
    padding: 1em;
    overflow-x: auto;
  }
  code {
    background: #f4f4f4;
    padding: 0.2em 0.4em;
    border-radius: 4px;
  }
  .note {
    border-left: 4px solid #008080;
    background: #e8f6f6;
    padding: 0.8em 1em;
    margin: 1em 0;
  }
  footer {
    font-size: 0.9em;
    color: #555;
    border-top: 1px solid #ddd;
    margin-top: 2em;
    padding-top: 1em;
  }
</style>
</head>
<body>

<h1>Quotas ‚Äî –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–∏—Å–∫–æ–≤–æ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞</h1>

<p><strong>Quotas</strong> –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –¥–∏—Å–∫–æ–≤–æ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞, –∑–∞–Ω–∏–º–∞–µ–º–æ–≥–æ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º –∏–ª–∏ –≥—Ä—É–ø–ø–æ–π.  
–ü–∞–∫–µ—Ç: <code>sys-fs/quota</code>.</p>

<p>–ü—Ä–∏–º–µ—Ä: —Å–æ–∑–¥–∞–¥–∏–º –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è <code>testuser</code> –Ω–∞ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ <strong>reiserfs</strong> –≤ —Ä–∞–∑–¥–µ–ª–µ, —Å–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–º –≤ <code>/home</code>, —Å –ª–∏–º–∏—Ç–æ–º 5 –ú–ë.</p>

<h2>1. –®–∞–≥–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</h2>

<ol>
  <li>–í–∫–ª—é—á–∏—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫—É –∫–≤–æ—Ç –≤ —è–¥—Ä–µ: <strong>File Systems ‚Üí Quota support</strong> –∏ –ø—Ä–æ—á–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã.</li>
  <li>–í —Ñ–∞–π–ª–µ <code>/etc/fstab</code> –¥–æ–±–∞–≤–∏—Ç—å –∫ –æ–ø—Ü–∏—è–º –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—è <code>usrquota,grpquota</code>.</li>
  <li>–ü–µ—Ä–µ–º–æ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å <code>/home</code> —Å –Ω–æ–≤—ã–º–∏ –æ–ø—Ü–∏—è–º–∏ (–∏–ª–∏ –≤—ã–ø–æ–ª–Ω–∏—Ç—å <code>reboot</code>).</li>
  <li>–í—ã–ø–æ–ª–Ω–∏—Ç—å <code>edquota -u testuser</code> –∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ <strong>hard</strong> –≤ –±–∞–π—Ç–∞—Ö ‚Äî <code>5120</code>.</li>
  <li>–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–ª—É–∂–±—É –∫–≤–æ—Ç: <code>/etc/init.d/quota restart</code>.</li>
</ol>

<p>–° —è–¥—Ä–æ–º <code>2.6.36-gentoo-r4</code> –∫–≤–æ—Ç—ã –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç –Ω–∞ <strong>reiserfs</strong>,  
–Ω–æ —Ä–∞–±–æ—Ç–∞—é—Ç –Ω–∞ <strong>ext4</strong>.  
–° —è–¥—Ä–æ–º <code>2.6.39-gentoo-r3</code> ‚Äî —Ä–∞–±–æ—Ç–∞—é—Ç –∏ –Ω–∞ <strong>reiserfs</strong>.</p>

<div class="note">
  üí° –¢–∞–∫–∂–µ —Å—Ç–æ–∏—Ç –æ–±—Ä–∞—Ç–∏—Ç—å –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ —Ñ–∞–π–ª <code>/etc/security/limits.conf</code> ‚Äî  
  –æ–Ω –∏–º–µ–µ—Ç –ø—Ä–æ—Å—Ç–æ–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å, –Ω–æ –º–æ–∂–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ —Ä–∞–∑–º–µ—Ä —Å–æ–∑–¥–∞–≤–∞–µ–º–æ–≥–æ —Ñ–∞–π–ª–∞,  
  –∞ –Ω–µ –æ–±—â–∏–π –æ–±—ä—ë–º –∑–∞–Ω—è—Ç–æ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞.
</div>

<h2>2. –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ –±–µ–∑ Quota</h2>

<p>–ú–æ–∂–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –±–µ–∑ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∫–≤–æ—Ç:  
—Å–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª –Ω—É–∂–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ –∏ –ø–æ–¥–º–æ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –µ–≥–æ –∫–∞–∫ —Ñ–∞–π–ª–æ–≤—É—é —Å–∏—Å—Ç–µ–º—É –≤ –¥–æ–º–∞—à–Ω–∏–π –∫–∞—Ç–∞–ª–æ–≥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.</p>

<pre><code>dd if=/dev/zero of=/userdisk.fs bs=1024 count=100000
mkfs.ext3 /userdisk.fs
mount -t ext3 -o loop /userdisk.fs /home/testuser
</code></pre>

<h2>3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</h2>

<p>–ß—Ç–æ–±—ã –æ—Ü–µ–Ω–∏—Ç—å –≤–ª–∏—è–Ω–∏–µ —Ç–∞–∫–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞ –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã,  
–º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–æ–º–∞–Ω–¥—É:</p>

<pre><code>time dd if=/dev/zero of=/home/testuser/testfile bs=1M count=1000
</code></pre>

<h3>–†–µ–∑—É–ª—å—Ç–∞—Ç—ã</h3>

<p><strong>–î–ª—è —Å–æ–∑–¥–∞–Ω–Ω–æ–π ext3:</strong></p>
<pre><code>astra ~ # time dd if=/dev/zero of=/home/testuser/testfile bs=1M count=800
800+0 –∑–∞–ø–∏—Å–µ–π —Å—á–∏—Ç–∞–Ω–æ
800+0 –∑–∞–ø–∏—Å–µ–π –Ω–∞–ø–∏—Å–∞–Ω–æ
—Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ 838860800 –±–∞–π—Ç (839 MB), 25.1175 c, 33.4 MB/c

real    0m25.119s
user    0m0.002s
sys     0m1.648s
</code></pre>

<p><strong>–î–ª—è —Å–æ–∑–¥–∞–Ω–Ω–æ–π reiserfs:</strong></p>
<pre><code>800+0 –∑–∞–ø–∏—Å–µ–π —Å—á–∏—Ç–∞–Ω–æ
800+0 –∑–∞–ø–∏—Å–µ–π –Ω–∞–ø–∏—Å–∞–Ω–æ
—Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ 838860800 –±–∞–π—Ç (839 MB), 41.1458 c, 20.4 MB/c

real    0m41.450s
user    0m0.003s
sys     0m2.387s
</code></pre>

<p><strong>–î–ª—è —Ç–µ–∫—É—â–µ–π reiserfs:</strong></p>
<pre><code>800+0 –∑–∞–ø–∏—Å–µ–π —Å—á–∏—Ç–∞–Ω–æ
800+0 –∑–∞–ø–∏—Å–µ–π –Ω–∞–ø–∏—Å–∞–Ω–æ
—Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ 838860800 –±–∞–π—Ç (839 MB), 10.0764 c, 83.3 MB/c

real    0m10.078s
user    0m0.000s
sys     0m2.477s
</code></pre>

<p>–º–¥–∞...</p>

<footer>
    (c) vesna
</footer>
</body>
</html>

